<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Java 8 Stream | 新月的博客</title>
    <meta property="og:title" content="Java 8 Stream - 新月的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2019-01-03T09:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2019-01-03T09:00:00&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="Java 8 Stream">
        
    <meta name="author" content="新月">
    <meta property="og:url" content="https://sangzhenya.github.io/post/Java/Java-8/Java-8-Stream/">
    <link rel="shortcut icon" href="https://sangzhenya.github.io/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='https://sangzhenya.github.io/css/normalize.css'>
    <link rel="stylesheet" href='https://sangzhenya.github.io/css/style.css'>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    


    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://sangzhenya.github.io/">
                        新月的博客
                    </a>
                
                <p class="description">晚来天欲雪，能饮一杯无？</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://sangzhenya.github.io/">首页</a>
                    
                    <a  href="https://sangzhenya.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="https://sangzhenya.github.io/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">Java 8 Stream</h1>
        </header>
        <date class="post-meta meta-date">
            2019年1月3日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='https://sangzhenya.github.io/categories/Java'>Java</a></span>
            
        </div>
        
        
        
        <div class="post-content">
            <h3 id="流与集合">流与集合</h3>
<h4 id="流">流</h4>
<p>流是 Java 的新 API，允许以声明的方式处理集合。简单来说你可以把流看作是遍历数据集的高级迭代器。此外流还可以透明的并行处理。Java 8的集合支持一个新的 stream 方法，这个方法会返回一个流。</p>
<h4 id="流与集合-1">流与集合</h4>
<p>粗略的来说流与集合的差异在于什么时候进行计算。集合是一个内存数据结构，包含数据结构中目前所有值。流则是概念上的数据结构，其元素是按需计算的。从另外一个角度说流就是一个延迟创建的集合。另外和迭代器类似，流只能遍历一次，遍历完表示该流已经被消费掉了，只能重新获取然后再次迭代。</p>
<h4 id="内部迭代和外部迭代">内部迭代和外部迭代</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> names <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> ArrayList<span style="color:#000;font-weight:bold">&lt;&gt;();</span>

<span style="color:#998;font-style:italic">// 外部迭代：使用增强 for 循环进行迭代
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span>Dog dog <span style="color:#000;font-weight:bold">:</span> dogList<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    names<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">add</span><span style="color:#000;font-weight:bold">(</span>dog<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">());</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#998;font-style:italic">// 外部迭代：使用迭代器进行迭代
</span><span style="color:#998;font-style:italic"></span>Iterator<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> iterator <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">iterator</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span>iterator<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hasNext</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
    Dog dog <span style="color:#000;font-weight:bold">=</span> iterator<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">next</span><span style="color:#000;font-weight:bold">();</span>
    names<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">add</span><span style="color:#000;font-weight:bold">(</span>dog<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">());</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#998;font-style:italic">// 内部迭代：使用流
</span><span style="color:#998;font-style:italic"></span>names <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getName<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><p>内部迭代和外部迭代如下图所示：</p>
<p><img src="https://i.loli.net/2019/04/25/5cc1bad68c7c0.png" alt="内部迭代和外部迭代"></p>
<h3 id="中间操作和终端操作">中间操作和终端操作</h3>
<p>一个简单的流操作</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> dogNames <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>d <span style="color:#000;font-weight:bold">-&gt;</span> d<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getWeight</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">&gt;</span> 99<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getName<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">limit</span><span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><p>图示如下：</p>
<p><img src="https://i.loli.net/2019/04/25/5cc1bcde06769.png" alt="流操作示意图"></p>
<p>图中可以看到两类操作：</p>
<ol>
<li>filter, map 和 limit 组成一条流水线。</li>
<li>collect 触发流水线执行并关闭它。</li>
</ol>
<h4 id="中间操作">中间操作</h4>
<p><code>java.util.stream.Stream</code>中的 Stream定义了很多操作，可以分为两类，其中可以连接起来的流操作称为中间操作。诸如 filter 或 sorted 等操作会返回一个流，这让多个操作连接起来的形成一个查询。另外流水线上至少有一个终端操作，否则中间操作不会执行任何处理。
中间操作如下列表：</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>返回类型</th>
<th>操作数</th>
<th>函数描述符</th>
</tr>
</thead>
<tbody>
<tr>
<td>filter</td>
<td>Stream<!-- raw HTML omitted --></td>
<td>Predicate<!-- raw HTML omitted --></td>
<td>T -&gt; boolean</td>
</tr>
<tr>
<td>map</td>
<td>Stream<!-- raw HTML omitted --></td>
<td>Function&lt;T, R&gt;</td>
<td>T -&gt; R</td>
</tr>
<tr>
<td>limit</td>
<td>Stream<!-- raw HTML omitted --></td>
<td></td>
<td></td>
</tr>
<tr>
<td>sorted</td>
<td>Stream<!-- raw HTML omitted --></td>
<td>Comparator<!-- raw HTML omitted --></td>
<td>(T, T) -&gt; int</td>
</tr>
<tr>
<td>distinct</td>
<td>Stream<!-- raw HTML omitted --></td>
<td></td>
<td></td>
</tr>
<tr>
<td>skip</td>
<td>Stream<!-- raw HTML omitted --></td>
<td>long</td>
<td></td>
</tr>
<tr>
<td>flatMap</td>
<td>Stream<!-- raw HTML omitted --></td>
<td>Function&lt;T, R&gt;</td>
<td>T -&gt; Stream<!-- raw HTML omitted --></td>
</tr>
</tbody>
</table>
<h4 id="终端操作">终端操作</h4>
<p>Stream 中另外一类操作称为终端操作，其会从流的流水线生成一个结果，其结果是任何不是流的值。
终端操作如下列表：</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>返回类型</th>
<th>操作数</th>
<th>函数描述符</th>
</tr>
</thead>
<tbody>
<tr>
<td>forEach</td>
<td>void</td>
<td>Consumer<!-- raw HTML omitted --></td>
<td>T -&gt; void</td>
</tr>
<tr>
<td>count</td>
<td>long</td>
<td></td>
<td></td>
</tr>
<tr>
<td>collect</td>
<td>R</td>
<td>Collector&lt;T, A, B&gt;</td>
<td></td>
</tr>
<tr>
<td>anyMatch</td>
<td>boolean</td>
<td>Predicate<!-- raw HTML omitted --></td>
<td>T -&gt; boolean</td>
</tr>
<tr>
<td>noneMatch</td>
<td>boolean</td>
<td>Predicate<!-- raw HTML omitted --></td>
<td>T -&gt; boolean</td>
</tr>
<tr>
<td>allMatch</td>
<td>boolean</td>
<td>Predicate<!-- raw HTML omitted --></td>
<td>T -&gt; boolean</td>
</tr>
<tr>
<td>findAny</td>
<td>Optional<!-- raw HTML omitted --></td>
<td></td>
<td></td>
</tr>
<tr>
<td>findFirst</td>
<td>Optional<!-- raw HTML omitted --></td>
<td></td>
<td></td>
</tr>
<tr>
<td>reduce</td>
<td>Optional<!-- raw HTML omitted --></td>
<td>BinaryOperator<!-- raw HTML omitted --></td>
<td>(T, T) -&gt; T</td>
</tr>
</tbody>
</table>
<h3 id="筛选和切片">筛选和切片</h3>
<h4 id="filter">filter</h4>
<p>filter 方法接受一个谓词作为参数，并返回一个包括所有符合谓词的元素的流。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> myDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="distinct">distinct</h4>
<p>distinct 会返回元素各异的流。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>Integer<span style="color:#000;font-weight:bold">&gt;</span> numbers <span style="color:#000;font-weight:bold">=</span> Arrays<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">asList</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">,</span> 2<span style="color:#000;font-weight:bold">,</span> 3<span style="color:#000;font-weight:bold">,</span> 4<span style="color:#000;font-weight:bold">,</span> 4<span style="color:#000;font-weight:bold">,</span> 3<span style="color:#000;font-weight:bold">,</span> 2<span style="color:#000;font-weight:bold">);</span>
numbers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>i <span style="color:#000;font-weight:bold">-&gt;</span> i <span style="color:#000;font-weight:bold">%</span> 2 <span style="color:#000;font-weight:bold">==</span> 0<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">distinct</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>println<span style="color:#000;font-weight:bold">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="limit">limit</h4>
<p>limit方法返回一个不超过指定长度的流，所需的长度通过参数传递给limit。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> limitDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>d <span style="color:#000;font-weight:bold">-&gt;</span> d<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getWeight</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">&gt;</span> 99<span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">limit</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="skip">skip</h4>
<p>skip 方法返回一个扔掉前 n 个元素的流。如果长度不够，则返回一个空流。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> skipDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>d <span style="color:#000;font-weight:bold">-&gt;</span> d<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getWeight</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">&gt;</span> 99<span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">skip</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="映射">映射</h3>
<h4 id="map">map</h4>
<p>流支持 map 方法其接受一个函数，并将该函数应用在每个元素上，映射成一个新的元素。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">List<span style="color:#000;font-weight:bold">&lt;</span>Integer<span style="color:#000;font-weight:bold">&gt;</span> dogNameLength <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getName<span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">::</span>length<span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="flatmap">flatMap</h4>
<p>如果有一个数组的列表想要生成一个扁平的元素的列表则可以使用  flatMap。其效果就是各个数组不是分别映射成一个流，而是映射成为流的内容。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String<span style="color:#000;font-weight:bold">[]</span> words <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#d14">&#34;Java&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;Stream&#34;</span><span style="color:#000;font-weight:bold">};</span>
Arrays<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">(</span>words<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>word <span style="color:#000;font-weight:bold">-&gt;</span> word<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;&#34;</span><span style="color:#000;font-weight:bold">))</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">flatMap</span><span style="color:#000;font-weight:bold">(</span>Arrays<span style="color:#000;font-weight:bold">::</span>stream<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">distinct</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">());</span>
</code></pre></td></tr></table>
</div>
</div><p>简单来说 flatMap 方法就是把流中每一个值都换成另外一个流，然后把所有的流连接起来成为一个流。</p>
<h3 id="查找和匹配">查找和匹配</h3>
<h4 id="match">match</h4>
<p><strong>anyMatch</strong>：至少一个match
<strong>allMatch</strong>：所有的match
<strong>noneMatch</strong>：没有一个match</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">anyMatch</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
     System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;There is at least one of mine&#34;</span><span style="color:#000;font-weight:bold">);</span>
 <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">allMatch</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
    System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;There all dog of mine&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">noneMatch</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
    System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;There is no dog of mine&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="find">find</h4>
<p><strong>findAny</strong>：返回当前流中的任一元素。
<strong>findFirst</strong>：返回当前流中的第一个元素。
例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Optional<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> myAnyDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findAny</span><span style="color:#000;font-weight:bold">();</span>
Optional<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> myFirstDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findFirst</span><span style="color:#000;font-weight:bold">();</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="规约-reduce">规约 reduce</h3>
<p>reduce 将流中的所有元素反复结合得到一个值。
例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#998;font-style:italic">// 使用原始方法求和
</span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span> sum <span style="color:#000;font-weight:bold">=</span> 0<span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span>Integer number <span style="color:#000;font-weight:bold">:</span> numbers<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	sum <span style="color:#000;font-weight:bold">+=</span> number<span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#998;font-style:italic">// 使用流的 reduce 方法求和
</span><span style="color:#998;font-style:italic"></span>sum <span style="color:#000;font-weight:bold">=</span> numbers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">reduce</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span>a<span style="color:#000;font-weight:bold">,</span> b<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">-&gt;</span> a <span style="color:#000;font-weight:bold">+</span> b<span style="color:#000;font-weight:bold">);</span>

<span style="color:#998;font-style:italic">// 求最大和最小值
</span><span style="color:#998;font-style:italic"></span>numbers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">reduce</span><span style="color:#000;font-weight:bold">(</span>Integer<span style="color:#000;font-weight:bold">::</span>max<span style="color:#000;font-weight:bold">);</span>
numbers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">reduce</span><span style="color:#000;font-weight:bold">(</span>Integer<span style="color:#000;font-weight:bold">::</span>min<span style="color:#000;font-weight:bold">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="收集-collect">收集 collect</h3>
<ol>
<li>
<p>最大值最小值</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Optional<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> heaviestDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors
     <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">maxBy</span><span style="color:#000;font-weight:bold">(</span>Comparator
         <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">comparingDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">)));</span>
Optional<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;</span> heaviestDog <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">max</span><span style="color:#000;font-weight:bold">(</span>Comparator
     <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">comparingDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">));</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>求和</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Double weight <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors
     <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">summingDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">));</span>
Double weight <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mapToDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">sum</span><span style="color:#000;font-weight:bold">();</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>连接字符串</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getName<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">joining</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;,&#34;</span><span style="color:#000;font-weight:bold">));</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>分组</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#998;font-style:italic">// 单级分组
</span><span style="color:#998;font-style:italic"></span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> List<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;&gt;</span> dogMap <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
                <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors
                        <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">groupingBy</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getGender<span style="color:#000;font-weight:bold">));</span>
<span style="color:#998;font-style:italic">// 多级分组
</span><span style="color:#998;font-style:italic"></span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> List<span style="color:#000;font-weight:bold">&lt;</span>Dog<span style="color:#000;font-weight:bold">&gt;&gt;&gt;</span> dogMap <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">groupingBy</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getGender<span style="color:#000;font-weight:bold">,</span> Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">groupingBy</span><span style="color:#000;font-weight:bold">(</span>dog <span style="color:#000;font-weight:bold">-&gt;</span> <span style="color:#000;font-weight:bold">{</span>
     <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>dog<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getWeight</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">&gt;</span> 99<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
         <span style="color:#000;font-weight:bold">return</span> <span style="color:#d14">&#34;SMALL&#34;</span><span style="color:#000;font-weight:bold">;</span>
     <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
         <span style="color:#000;font-weight:bold">return</span> <span style="color:#d14">&#34;Big&#34;</span><span style="color:#000;font-weight:bold">;</span>
     <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">})));</span>
   
<span style="color:#998;font-style:italic">// 按子组收集数据
</span><span style="color:#998;font-style:italic"></span>dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
 <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">groupingBy</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getGender<span style="color:#000;font-weight:bold">,</span> 
     Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">counting</span><span style="color:#000;font-weight:bold">()));</span>
   
dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">groupingBy</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getGender<span style="color:#000;font-weight:bold">,</span> 
         Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">maxBy</span><span style="color:#000;font-weight:bold">(</span>Comparator
             <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">comparingDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">))));</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>分区</p>
<p>分区是分组的特殊情况，由一个谓词即返回 boolean 的函数作为分类函数，即分区函数。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors
     <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">partitioningBy</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>isOwn<span style="color:#000;font-weight:bold">));</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Collectors 类的静态工厂方法</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>工厂方法</th>
<th>返回类型</th>
<th>用于</th>
</tr>
</thead>
<tbody>
<tr>
<td>toList</td>
<td>List<!-- raw HTML omitted --></td>
<td>把流中所有的项目收集到一个 List</td>
</tr>
<tr>
<td>toSet</td>
<td>Set<!-- raw HTML omitted --></td>
<td>把流中所有的项目收集到一个 Set</td>
</tr>
<tr>
<td>toCollection</td>
<td>Collection<!-- raw HTML omitted --></td>
<td>把流中所有的项目收集到给定的供应源创建的集合</td>
</tr>
<tr>
<td>counting</td>
<td>Long</td>
<td>计算流中元素的个数</td>
</tr>
<tr>
<td>summingInt</td>
<td>Integer</td>
<td>对流中的项目的一个整数属性求和</td>
</tr>
<tr>
<td>averagingInt</td>
<td>Double</td>
<td>计算流中项目的 Integer 属性的平均值</td>
</tr>
<tr>
<td>summarizingInt</td>
<td>IntSummaryStatistics</td>
<td>收集关于流中项目 Integer 属性的统计值，例如最大、最小、总和与平均值</td>
</tr>
<tr>
<td>joining</td>
<td>String</td>
<td>连接对流中每个项目调用 toString 方法产生的字符串</td>
</tr>
<tr>
<td>maxBy</td>
<td>Optional<!-- raw HTML omitted --></td>
<td>一个包裹了流中按照给定的比较器选出的最大元素的 Optional，或如果流为空为 Optional.empty()</td>
</tr>
<tr>
<td>minBy</td>
<td>Optional<!-- raw HTML omitted --></td>
<td>一个包裹了流中按照给定的比较器出选出最小元素的Optional， 或如果流为空为 Optional.empty()</td>
</tr>
<tr>
<td>reducing</td>
<td>规约操作产生的类型</td>
<td>一个作为累加器的初始值的开始，利用 BinaryOperator 与流中元素逐个结合，从而将流规约为单个值</td>
</tr>
<tr>
<td>collectingAndThen</td>
<td>转换函数返回的类型</td>
<td>包裹另外一个收集器，对其结果应用转换函数</td>
</tr>
<tr>
<td>groupingBy</td>
<td>Map&lt;K, List<!-- raw HTML omitted -->&gt;</td>
<td>根据项目的一个属性的值对流中的项目进行分组，并记得属性值作为结果 Map 的键</td>
</tr>
<tr>
<td>partitioningBy</td>
<td>Map&lt;Boolean, List<!-- raw HTML omitted -->&gt;</td>
<td>根据对流中的项目的应用谓词的结果进行分区</td>
</tr>
</tbody>
</table>
<h3 id="数值流">数值流</h3>
<p>Java 8 提供了三个原始类型的特化流来解决操作数值时可能暗含的装箱成本。分别是：IntStream, DoubleStream, LongStream  分别来流中的元素特化位为 int，double 和 long。例如：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#998;font-style:italic">// 使用包装类型求和
</span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">double</span> totalWeigh <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">reduce</span><span style="color:#000;font-weight:bold">(</span>0d<span style="color:#000;font-weight:bold">,</span> Double<span style="color:#000;font-weight:bold">::</span>sum<span style="color:#000;font-weight:bold">);</span>

<span style="color:#998;font-style:italic">// 使用数值类型流求和
</span><span style="color:#998;font-style:italic">// 映射到数值流
</span><span style="color:#998;font-style:italic"></span>totalWeigh <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mapToDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">sum</span><span style="color:#000;font-weight:bold">();</span>

<span style="color:#998;font-style:italic">// 转换回对象流
</span><span style="color:#998;font-style:italic"></span>dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mapToDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">boxed</span><span style="color:#000;font-weight:bold">();</span>
</code></pre></td></tr></table>
</div>
</div><p>对于求最大值的情况，流中可能并不存在最大值，对于这种情况使用默认值是 0 的话，显然是错误的。这个时候需要引入一个新的类 <code>OptionalDouble</code> 。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#998;font-style:italic">// 查找流中最大值
</span><span style="color:#998;font-style:italic"></span>OptionalDouble maxWeight <span style="color:#000;font-weight:bold">=</span> dogList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mapToDouble</span><span style="color:#000;font-weight:bold">(</span>Dog<span style="color:#000;font-weight:bold">::</span>getWeight<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">max</span><span style="color:#000;font-weight:bold">();</span>

<span style="color:#998;font-style:italic">// 如果没有最大值，可以显示定义一个默认值
</span><span style="color:#998;font-style:italic"></span>maxWeight<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">orElse</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>

<span style="color:#998;font-style:italic">// 生成一定范围数值的数字
</span><span style="color:#998;font-style:italic"></span>IntStream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">rangeClosed</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">,</span> 100<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>n <span style="color:#000;font-weight:bold">-&gt;</span> n <span style="color:#000;font-weight:bold">%</span> 2 <span style="color:#000;font-weight:bold">==</span> 0<span style="color:#000;font-weight:bold">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="构建流">构建流</h3>
<h4 id="由值构建">由值构建</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Stream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">of</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Java&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;Stream&#34;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">::</span>toUpperCase<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>println<span style="color:#000;font-weight:bold">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="由数组构建">由数组构建</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">[]</span> numbers <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>1<span style="color:#000;font-weight:bold">,</span> 2<span style="color:#000;font-weight:bold">,</span> 3<span style="color:#000;font-weight:bold">,</span> 4<span style="color:#000;font-weight:bold">,</span> 5<span style="color:#000;font-weight:bold">};</span>
<span style="color:#458;font-weight:bold">int</span> sum <span style="color:#000;font-weight:bold">=</span> Arrays<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">(</span>numbers<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">sum</span><span style="color:#000;font-weight:bold">();</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="由文件生成流">由文件生成流</h4>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#458;font-weight:bold">long</span> uniqueWords <span style="color:#000;font-weight:bold">=</span> 0<span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">(</span>Stream<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> lines <span style="color:#000;font-weight:bold">=</span> Files<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lines</span><span style="color:#000;font-weight:bold">(</span>Paths<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;data.txt&#34;</span><span style="color:#000;font-weight:bold">),</span> Charset<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">defaultCharset</span><span style="color:#000;font-weight:bold">()))</span> <span style="color:#000;font-weight:bold">{</span>
    uniqueWords <span style="color:#000;font-weight:bold">=</span> lines<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">flatMap</span><span style="color:#000;font-weight:bold">(</span>line <span style="color:#000;font-weight:bold">-&gt;</span> Arrays<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">(</span>line<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34; &#34;</span><span style="color:#000;font-weight:bold">))).</span><span style="color:#008080">distinct</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">count</span><span style="color:#000;font-weight:bold">();</span>  
<span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>IOException e<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="由函数生成流">由函数生成流</h4>
<p>Stream 提供了两个静态方法来从函数中生成流：Stream.iterate 和 Stream.generate。 这两个操作可以创建所谓的无限流：即由 iterate 和 generate 产生的流会用给定的函数按需创建，可以无穷尽的计算下去，一般来说应该使用 limit(n) 来对这种流加以限制。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#998;font-style:italic">// 简单的迭代
</span><span style="color:#998;font-style:italic"></span>Stream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">iterate</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">,</span> n <span style="color:#000;font-weight:bold">-&gt;</span> n <span style="color:#000;font-weight:bold">+</span> 2<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">limit</span><span style="color:#000;font-weight:bold">(</span>10<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>println<span style="color:#000;font-weight:bold">);</span>

<span style="color:#998;font-style:italic">// 简单的生成
</span><span style="color:#998;font-style:italic"></span>Stream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">generate</span><span style="color:#000;font-weight:bold">(</span>Math<span style="color:#000;font-weight:bold">::</span>random<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">limit</span><span style="color:#000;font-weight:bold">(</span>5<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>println<span style="color:#000;font-weight:bold">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="收集器接口">收集器接口</h3>
<p>Collector 接口包含了一系列方法，为实现具体的规约操作提供了样本。其定义了以下五个接口：</p>
<h4 id="supplier">supplier</h4>
<p>supplier 方法用于建立新的结果容器。其返回一个结果为空的 Supplier，也就是一个无参数函数，在调用时它会产生一个空的累加器实例，供数据收集过程使用。</p>
<h4 id="accumulator">accumulator</h4>
<p>accumulator 方法用于将元素添加到结果容器。其返回执行规约操作的函数。当遍历到流中第 n 个元素时，这时会有两个参数：保存规约结果的累加器，还有第 n 个元素本身。该函数将返回 void，因为累加器是原位更新，即函数的执行改变了它的内部状态以提现遍历元素的效果。</p>
<h4 id="finisher">finisher</h4>
<p>finisher 方法用于对结果容器应用最终转换。在遍历完流后，finisher 方法必须返回在累加过程的最后一个调用的函数，以便将累加器对象转换为整个集合操作的最终结果。</p>
<h4 id="combiner">combiner</h4>
<p>combiner 方法用于合并两个结果容器。其返回一个供规约操作使用的函数，其定义了对流的各个子部分的进行并行处理时，各个子部分规约所得累加器要如何合并。</p>
<h4 id="characteristics">characteristics</h4>
<p>characteristics 方法返回一个不可变的 Characteristcs 集合，其定义了收集器的行为，尤其是流是否可以并行规约，以及可以使用哪些优化的提示。包含以下三个枚举：</p>
<ol>
<li>UNORDERED ：规约结果不受流中项目遍历和累积顺序的影响。</li>
<li>CONCURRENT ：accumulator 函数可以从多个线程调用，且收集器可以并行规约流，如果收集器没有标为 UNORDERED，那它仅用于无序数据源时才可以并行归纳。</li>
<li>IDENTITY_FINISH ：表明完成器方法返回的函数是一个恒等函数可以跳过，这种情况下累加器对象将会直接用作规约过程的最终结果。意味着累加器 A 不加检查转换为结果 R 是安全的。</li>
</ol>
<p>一个过程图如下：</p>
<p><img src="https://i.loli.net/2019/04/27/5cc32e23b6749.png" alt="一个规约过程图"></p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="https://sangzhenya.github.io/post/Java/Java-8/Java-8-Lambda/">Java 8 Lambda</a></li>
        
        <li><a href="https://sangzhenya.github.io/post/Java/JUC1/Java-ConcurrentHashMap/">Java ConcurrentHashMap</a></li>
        
        <li><a href="https://sangzhenya.github.io/post/Java/JUC1/Java-CAS/">Java CAS</a></li>
        
        <li><a href="https://sangzhenya.github.io/post/Java/JUC1/Java-volatile/">Java volatile</a></li>
        
        <li><a href="https://sangzhenya.github.io/post/Java/JUC1/Java-ReentrantLock/">Java ReentrantLock</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://sangzhenya.github.io/tags/java'>java</a></li>
                
                <li><a href='https://sangzhenya.github.io/tags/JDK8'>JDK8</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='//www.google.com/search' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://sangzhenya.github.io/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-JNDI/" title="Java JNDI">Java JNDI</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-OOM/" title="Java OOM">Java OOM</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-JVM/" title="Java JVM">Java JVM</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-HotSpot-GC-%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" title="Java HotSpot GC 算法实现">Java HotSpot GC 算法实现</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-GC-2/" title="Java GC 2">Java GC 2</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-GC-1/" title="Java GC 1">Java GC 1</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" title="Java 虚拟机内存模型">Java 虚拟机内存模型</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90/" title="Java 逃逸分析">Java 逃逸分析</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/Java/JVM1/Java-%E5%9B%9B%E7%A7%8D%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/" title="Java 四种引用类型">Java 四种引用类型</a>
    </li>
    
    <li>
        <a href="https://sangzhenya.github.io/post/%E5%BE%AE%E6%9C%8D%E5%8A%A1/dubbo/Dubbo-%E5%8E%9F%E7%90%86/" title="Dubbo 原理">Dubbo 原理</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">分类</h3>
<ul class="widget-list">
    
    <li><a href="https://sangzhenya.github.io/categories/Java/">Java (22)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/MQ/">MQ (3)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/MyBaits/">MyBaits (7)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/MySQL/">MySQL (4)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/Netty/">Netty (10)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/Nginx/">Nginx (2)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/Redis/">Redis (2)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/Spring/">Spring (36)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/%E5%85%B3%E4%BA%8E/">关于 (1)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/%E5%85%B6%E4%BB%96/">其他 (8)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务 (11)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/%E7%AE%97%E6%B3%95/">算法 (3)</a></li>
    
    <li><a href="https://sangzhenya.github.io/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记 (7)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title">标签</h3>
<div class="tagcloud">
    
    <a href="https://sangzhenya.github.io/tags/Active-MQ/">Active MQ</a>
    
    <a href="https://sangzhenya.github.io/tags/Cookie/">Cookie</a>
    
    <a href="https://sangzhenya.github.io/tags/Debug/">Debug</a>
    
    <a href="https://sangzhenya.github.io/tags/Docker/">Docker</a>
    
    <a href="https://sangzhenya.github.io/tags/Dubbo/">Dubbo</a>
    
    <a href="https://sangzhenya.github.io/tags/Git/">Git</a>
    
    <a href="https://sangzhenya.github.io/tags/JDK8/">JDK8</a>
    
    <a href="https://sangzhenya.github.io/tags/JPA/">JPA</a>
    
    <a href="https://sangzhenya.github.io/tags/JUC/">JUC</a>
    
    <a href="https://sangzhenya.github.io/tags/JVM/">JVM</a>
    
    <a href="https://sangzhenya.github.io/tags/java/">java</a>
    
    <a href="https://sangzhenya.github.io/tags/Jenkins/">Jenkins</a>
    
    <a href="https://sangzhenya.github.io/tags/Kafka/">Kafka</a>
    
    <a href="https://sangzhenya.github.io/tags/Kubernetes/">Kubernetes</a>
    
    <a href="https://sangzhenya.github.io/tags/Linux/">Linux</a>
    
    <a href="https://sangzhenya.github.io/tags/Maven/">Maven</a>
    
    <a href="https://sangzhenya.github.io/tags/MyBaits/">MyBaits</a>
    
    <a href="https://sangzhenya.github.io/tags/MySQL/">MySQL</a>
    
    <a href="https://sangzhenya.github.io/tags/Netty/">Netty</a>
    
    <a href="https://sangzhenya.github.io/tags/Nginx/">Nginx</a>
    
    <a href="https://sangzhenya.github.io/tags/Rabbit-MQ/">Rabbit MQ</a>
    
    <a href="https://sangzhenya.github.io/tags/Redis/">Redis</a>
    
    <a href="https://sangzhenya.github.io/tags/Rocket-MQ/">Rocket MQ</a>
    
    <a href="https://sangzhenya.github.io/tags/Session/">Session</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring/">Spring</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring-Boot/">Spring Boot</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring-Cloud/">Spring Cloud</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring-Data/">Spring Data</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring-MVC/">Spring MVC</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring-Security/">Spring Security</a>
    
    <a href="https://sangzhenya.github.io/tags/Spring-%E6%B3%A8%E8%A7%A3/">Spring 注解</a>
    
    <a href="https://sangzhenya.github.io/tags/Tmux/">Tmux</a>
    
    <a href="https://sangzhenya.github.io/tags/Zookeeper/">Zookeeper</a>
    
    <a href="https://sangzhenya.github.io/tags/java/">java</a>
    
    <a href="https://sangzhenya.github.io/tags/%E4%BB%A3%E7%A0%81/">代码</a>
    
    <a href="https://sangzhenya.github.io/tags/%E5%85%B3%E4%BA%8E/">关于</a>
    
    <a href="https://sangzhenya.github.io/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a>
    
    <a href="https://sangzhenya.github.io/tags/%E6%BA%90%E7%A0%81/">源码</a>
    
    <a href="https://sangzhenya.github.io/tags/%E7%AE%97%E6%B3%95/">算法</a>
    
    <a href="https://sangzhenya.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a>
    
    <a href="https://sangzhenya.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
    
    <a href="https://sangzhenya.github.io/tags/%E9%9B%86%E5%90%88/">集合</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://sangzhenya.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
    <footer id="footer">
    <div class="container">
        &copy; 2020 <a href="https://sangzhenya.github.io/">新月的博客 By 新月</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        Theme based on <a href="https://github.com/flysnow-org/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>


<a id="rocket" href="#top"></a>
<script type="text/javascript" src='https://sangzhenya.github.io/js/totop.js?v=0.0.0' async=""></script>






</body>

</html>